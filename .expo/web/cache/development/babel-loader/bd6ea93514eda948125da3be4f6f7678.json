{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from \"react\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport { images, colors, icons, fontSizes } from \"../../../constants\";\nimport Icon from \"@expo/vector-icons/FontAwesome5\";\nimport { UIHeader } from \"../../../components\";\nimport MessengerItem from \"./MessengerItem\";\nimport { TextInput } from \"react-native-gesture-handler\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { auth, onAuthStateChanged, firebaseDatabaseRef, firebaseSet, firebaseDatabase } from \"../../../../config\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nfunction Messenger(props) {\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      typedText = _useState2[0],\n      setTypedText = _useState2[1];\n\n  var _useState3 = useState([{\n    url: \"https://randomuser.me/api/portraits/men/70.jpg\",\n    showUrl: true,\n    isSender: true,\n    messenger: \"Hello\",\n    timestamp: 1641654238000\n  }, {\n    url: \"https://randomuser.me/api/portraits/men/70.jpg\",\n    showUrl: false,\n    isSender: true,\n    messenger: \"How are you ?\",\n    timestamp: 1641654298000\n  }, {\n    url: \"https://randomuser.me/api/portraits/men/70.jpg\",\n    showUrl: false,\n    isSender: true,\n    messenger: \"How about your work ?. nujdhsfuhduf dhuhu uhuh uhfudhufduhu hufhfd\",\n    timestamp: 1641654538000\n  }, {\n    url: \"https://randomuser.me/api/portraits/men/50.jpg\",\n    showUrl: true,\n    isSender: false,\n    messenger: \"Yes\",\n    timestamp: 1641654598000\n  }, {\n    url: \"https://randomuser.me/api/portraits/men/50.jpg\",\n    showUrl: false,\n    isSender: false,\n    messenger: \"I am fine\",\n    timestamp: 1641654598000\n  }, {\n    url: \"https://randomuser.me/api/portraits/men/70.jpg\",\n    showUrl: true,\n    isSender: true,\n    messenger: \"Let's go out\",\n    timestamp: 1641654778000\n  }]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      chatHistory = _useState4[0],\n      setChatHistory = _useState4[1];\n\n  var _props$route$params$u = props.route.params.user,\n      url = _props$route$params$u.url,\n      name = _props$route$params$u.name,\n      userId = _props$route$params$u.userId;\n  var _props$navigation = props.navigation,\n      navigate = _props$navigation.navigate,\n      goBack = _props$navigation.goBack;\n  return _jsxs(View, {\n    style: {\n      flexDirection: \"column\",\n      flex: 1\n    },\n    children: [_jsx(UIHeader, {\n      title: name,\n      leftIconName: \"arrow-left\",\n      rightIconName: \"ellipsis-v\",\n      onPressLeftIcon: function onPressLeftIcon() {\n        goBack();\n      },\n      onPressRightIcon: function onPressRightIcon() {\n        alert(\"press right icon\");\n      }\n    }), _jsx(FlatList, {\n      style: {\n        flex: 1\n      },\n      data: chatHistory,\n      renderItem: function renderItem(_ref) {\n        var item = _ref.item;\n        return _jsx(MessengerItem, {\n          onPress: function onPress() {\n            alert(\"You press item's name: \" + item.timestamp);\n          },\n          item: item\n        }, \"\" + item.timestamp);\n      }\n    }), _jsxs(View, {\n      style: {\n        height: 50,\n        position: \"absolute\",\n        bottom: 100,\n        left: 0,\n        right: 0,\n        flexDirection: \"row\",\n        justifyContent: \"space-between\",\n        alignItems: \"center\"\n      },\n      children: [_jsx(TextInput, {\n        onChangeText: function onChangeText(typedText) {\n          setTypedText(typedText);\n        },\n        style: {\n          color: \"black\",\n          paddingStart: 10\n        },\n        placeholder: \"Enter your message here\",\n        value: typedText,\n        placeholderTextColor: colors.placeholder\n      }), _jsx(TouchableOpacity, {\n        onPress: function _callee() {\n          var stringUser, myUserId, myFriendUserId, newMessengerObject;\n          return _regeneratorRuntime.async(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  if (!(typedText.trim().length == 0)) {\n                    _context.next = 2;\n                    break;\n                  }\n\n                  return _context.abrupt(\"return\");\n\n                case 2:\n                  debugger;\n                  _context.next = 5;\n                  return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"user\"));\n\n                case 5:\n                  stringUser = _context.sent;\n                  myUserId = \"1\";\n                  myFriendUserId = \"2\";\n                  newMessengerObject = {\n                    url: \"https://randomuser.me/api/portraits/men/50.jpg\",\n                    showUrl: false,\n                    messenger: typedText,\n                    timestamp: new Date().getTime()\n                  };\n                  Keyboard.dismiss();\n                  firebaseSet(firebaseDatabaseRef(firebaseDatabase, \"chats/\" + myUserId + \"-\" + myFriendUserId).key, newMessengerObject).then(function () {\n                    setTypedText(\"\");\n                  });\n\n                case 11:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, null, null, null, Promise);\n        },\n        children: _jsx(Icon, {\n          style: {\n            padding: 10\n          },\n          name: \"paper-plane\",\n          size: 20,\n          color: colors.primary\n        })\n      })]\n    })]\n  });\n}\n\nexport default Messenger;","map":{"version":3,"names":["React","useState","useEffect","images","colors","icons","fontSizes","Icon","UIHeader","MessengerItem","TextInput","AsyncStorage","auth","onAuthStateChanged","firebaseDatabaseRef","firebaseSet","firebaseDatabase","Messenger","props","typedText","setTypedText","url","showUrl","isSender","messenger","timestamp","chatHistory","setChatHistory","route","params","user","name","userId","navigation","navigate","goBack","flexDirection","flex","alert","item","height","position","bottom","left","right","justifyContent","alignItems","color","paddingStart","placeholder","trim","length","getItem","stringUser","myUserId","myFriendUserId","newMessengerObject","Date","getTime","Keyboard","dismiss","key","then","padding","primary"],"sources":["D:/All/DuAnTotNghiep_ReactNative/GiaoDienApp/src/layout/product/Messenger/Messenger.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  Text,\r\n  View,\r\n  Image,\r\n  ImageBackground,\r\n  TouchableOpacity,\r\n  FlatList,\r\n  Keyboard,\r\n} from \"react-native\";\r\nimport { images, colors, icons, fontSizes } from \"../../../constants\";\r\nimport Icon from \"react-native-vector-icons/FontAwesome5\";\r\nimport { UIHeader } from \"../../../components\";\r\nimport MessengerItem from \"./MessengerItem\";\r\nimport { TextInput } from \"react-native-gesture-handler\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport {\r\n  auth,\r\n  onAuthStateChanged,\r\n  firebaseDatabaseRef,\r\n  firebaseSet,\r\n  firebaseDatabase,\r\n} from \"../../../../config\";\r\n\r\nfunction Messenger(props) {\r\n  const [typedText, setTypedText] = useState(\"\");\r\n  const [chatHistory, setChatHistory] = useState([\r\n    {\r\n      url: \"https://randomuser.me/api/portraits/men/70.jpg\",\r\n      showUrl: true,\r\n      isSender: true,\r\n      messenger: \"Hello\",\r\n      timestamp: 1641654238000,\r\n    },\r\n    {\r\n      url: \"https://randomuser.me/api/portraits/men/70.jpg\",\r\n      showUrl: false,\r\n      isSender: true,\r\n      messenger: \"How are you ?\",\r\n      timestamp: 1641654298000,\r\n    },\r\n    {\r\n      url: \"https://randomuser.me/api/portraits/men/70.jpg\",\r\n      showUrl: false,\r\n      isSender: true,\r\n      messenger:\r\n        \"How about your work ?. nujdhsfuhduf dhuhu uhuh uhfudhufduhu hufhfd\",\r\n      timestamp: 1641654538000,\r\n    },\r\n    {\r\n      url: \"https://randomuser.me/api/portraits/men/50.jpg\",\r\n      showUrl: true,\r\n      isSender: false,\r\n      messenger: \"Yes\",\r\n      timestamp: 1641654598000,\r\n    },\r\n    {\r\n      url: \"https://randomuser.me/api/portraits/men/50.jpg\",\r\n      showUrl: false,\r\n      isSender: false,\r\n      messenger: \"I am fine\",\r\n      timestamp: 1641654598000,\r\n    },\r\n    {\r\n      url: \"https://randomuser.me/api/portraits/men/70.jpg\",\r\n      showUrl: true,\r\n      isSender: true,\r\n      messenger: \"Let's go out\",\r\n      timestamp: 1641654778000,\r\n    },\r\n  ]);\r\n  const { url, name, userId } = props.route.params.user;\r\n  const { navigate, goBack } = props.navigation;\r\n  return (\r\n    <View\r\n      style={{\r\n        flexDirection: \"column\",\r\n        flex: 1,\r\n      }}\r\n    >\r\n      <UIHeader\r\n        title={name}\r\n        leftIconName={\"arrow-left\"}\r\n        rightIconName={\"ellipsis-v\"}\r\n        onPressLeftIcon={() => {\r\n          goBack();\r\n        }}\r\n        onPressRightIcon={() => {\r\n          alert(\"press right icon\");\r\n        }}\r\n      />\r\n\r\n      <FlatList\r\n        style={{\r\n          flex: 1,\r\n        }}\r\n        data={chatHistory}\r\n        renderItem={({ item }) => (\r\n          <MessengerItem\r\n            onPress={() => {\r\n              alert(`You press item's name: ${item.timestamp}`);\r\n            }}\r\n            item={item}\r\n            key={`${item.timestamp}`}\r\n          />\r\n        )}\r\n      />\r\n      <View\r\n        style={{\r\n          height: 50,\r\n          position: \"absolute\",\r\n          bottom: 100,\r\n          left: 0,\r\n          right: 0,\r\n          flexDirection: \"row\",\r\n          justifyContent: \"space-between\",\r\n          alignItems: \"center\",\r\n        }}\r\n      >\r\n        <TextInput\r\n          onChangeText={(typedText) => {\r\n            setTypedText(typedText);\r\n          }}\r\n          style={{\r\n            color: \"black\",\r\n            paddingStart: 10,\r\n          }}\r\n          placeholder=\"Enter your message here\"\r\n          value={typedText}\r\n          placeholderTextColor={colors.placeholder}\r\n        />\r\n        <TouchableOpacity\r\n          onPress={async () => {\r\n            if (typedText.trim().length == 0) {\r\n              return;\r\n            }\r\n            debugger;\r\n            let stringUser = await AsyncStorage.getItem(\"user\");\r\n            let myUserId = \"1\";\r\n            let myFriendUserId = \"2\";\r\n            //save to Firebase DB\r\n            let newMessengerObject = {\r\n              //fake\r\n              url: \"https://randomuser.me/api/portraits/men/50.jpg\",\r\n              showUrl: false,\r\n              messenger: typedText,\r\n              timestamp: new Date().getTime(),\r\n            };\r\n            Keyboard.dismiss();\r\n            firebaseSet(\r\n              firebaseDatabaseRef(\r\n                firebaseDatabase,\r\n                `chats/${myUserId}-${myFriendUserId}`\r\n              ).key,\r\n              newMessengerObject\r\n            ).then(() => {\r\n              setTypedText(\"\");\r\n            });\r\n\r\n            //\"id1-id2\": {messenger object}\r\n          }}\r\n        >\r\n          <Icon\r\n            style={{\r\n              padding: 10,\r\n            }}\r\n            name=\"paper-plane\"\r\n            size={20}\r\n            color={colors.primary}\r\n          />\r\n        </TouchableOpacity>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\nexport default Messenger;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}